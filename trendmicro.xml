<?xml version="1.0" encoding="UTF-8"?>

<!--
  NOTES
  1) we must uninstall on first install if a previous autopcc installation exists
-->

<packages>

<package
  id='trendmicro'
  name="Trend Micro OfficeScan"
  revision="%version%-3"
  reboot="false">

  <variable name="version" value="10.5" />
  <variable name="fileversion" value="10.5.0.1766" />
  <variable name="directory_32" value="%PROGRAMFILES%\Trend Micro\OfficeScan Client" />
  <variable name="directory_64" value="%PROGRAMFILES(x86)%\Trend Micro\OfficeScan Client" />

  <check type="logical" condition="and">
    <check type="uninstall" condition="versiongreaterorequal" path="Trend Micro OfficeScan Client" value="%version%" />
    <check type="logical" condition="or">
      <check type="file" condition="versiongreaterorequal" path="%PROGRAMFILES%\Trend Micro\OfficeScan Client\PccNt.exe" value="%fileversion%" />
      <check type="file" condition="versiongreaterorequal" path="%PROGRAMFILES(x86)%\Trend Micro\OfficeScan Client\PccNt.exe" value="%fileversion%" />
    </check>
  </check>

  <install cmd='%COMSPEC% /c IF EXIST "%directory_32%\ntrmv.exe" "%directory_32%\ntrmv.exe"' />
  <install cmd='%COMSPEC% /c IF EXIST "%directory_64%\ntrvm.exe" "%directory_64%\ntrmv.exe"' />
  <install cmd='msiexec %MSI% /i "%SOFTWARE%\TrendMicro\OfficeScan\client_105.msi"' />

  <upgrade cmd='msiexec %MSI% /i "%SOFTWARE%\TrendMicro\OfficeScan\client_105.msi"' />

  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\TrendMicro\OfficeScan\client_105.msi"' />

  <remove cmd='msiexec %MSI% /x "%SOFTWARE%\TrendMicro\OfficeScan\client_105.msi"' />
</package>

</packages>
