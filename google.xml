<?xml version="1.0" encoding="UTF-8"?>

<packages>

<!--
  SOURCE
  1) Go to google.com/earth for download
  2) Deselect Chrome options
  3) Click "advanced setup"
  4) DESELECTED "Allow Google Earth to automatically install recommended updates."
  5) Select "Make Google Earth available to all users' profiles. Administrative rights are required."
  6) Extract using 7zip
-->

<package
  id="googleearth"
  name="Google Earth"
  revision="%version%-0"
  reboot="false"
  priority="10">

  <variable name="version" value="6.0.3.2197" />
  <variable name="shortversion" value="6.0" />

  <check type="uninstall" condition="versiongreaterorequal" path="Google Earth" value="%version%" />

  <install cmd='%COMSPEC% /C "md %SystemDrive%\netinst\logs\"' >
    <exit code="0" />
    <exit code="1" /> <!-- directory already exists -->
  </install>
  <install   cmd='msiexec %MSI% /i "%SOFTWARE%\Google\Google Earth\%shortversion%\Google Earth.msi"' />
  <upgrade   cmd='msiexec %MSI% /i "%SOFTWARE%\Google\Google Earth\%shortversion%\Google Earth.msi"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Google\Google Earth\%shortversion%\Google Earth.msi"' />
  <remove    cmd='msiexec %MSI% /x "%SOFTWARE%\Google\Google Earth\%shortversion%\Google Earth.msi"' />

</package>

<package
  id="google_picasa"
  name="Picasa 3.8"
  revision="%version%-0"
  priority="10"
  reboot="false" >

  <variable name="version" value="3.8" />
  <variable name="fileversion" value="38" />

  <check type='uninstall' condition='versiongreaterorequal' path='Picasa 3' value='%version%' />

  <install cmd='"%SOFTWARE%\Google\Picasa\picasa%fileversion%-setup.exe" /S /L' >
    <exit code='1' />
    <exit code='128' />
  </install>
  <install cmd='sc config gusvc start= disabled' />

  <upgrade cmd='"%SOFTWARE%\Google\Picasa\picasa%fileversion%-setup.exe" /S /L' >
    <exit code='1' />
    <exit code='128' />
  </upgrade>
  <upgrade cmd='sc config gusvc start= disabled' />

  <downgrade cmd='"%SOFTWARE%\Google\Picasa\picasa%fileversion%-setup.exe" /S /L' >
    <exit code='1' />
    <exit code='128' />
  </downgrade>
  <downgrade cmd='sc config gusvc start= disabled' />

  <remove cmd='%COMSPEC% /c IF EXIST "%PROGRAMFILES%\Google\Picasa3\Uninstall.exe" "%PROGRAMFILES%\Google\Picasa3\Uninstall.exe" /S' />
  <remove cmd='%COMSPEC% /c IF EXIST "%PROGRAMFILES(x86)%\Google\Picasa3\Uninstall.exe" "%PROGRAMFILES(x86)%\Google\Picasa3\Uninstall.exe" /S' />

</package>

<package
  id="googletalk"
  name="Google Talk"
  revision="%version%-3"
  priority="10"
  reboot="false">

  <variable name="version" value="1.0.0.104" />

  <check type="logical" condition="or">
    <check type="file" condition="versiongreaterorequal" path="%PROGRAMFILES%\Google\Google Talk\googletalk.exe" value="%version%" />
    <check type="file" condition="versiongreaterorequal" path="%PROGRAMFILES(x86)%\Google\Google Talk\googletalk.exe" value="%version%" />
  </check>

  <install cmd='"%SOFTWARE%\Google\Google Talk\googletalk-setup.exe" /S' />
  <install cmd='taskkill /f /IM googletalk.exe'><exit code="any" /></install>
  <install cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v googletalk /f'><exit code="1" /></install>
  <install cmd='REG DELETE "HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Run" /v googletalk /f' architecture="x64"><exit code="1" /></install>

  <upgrade cmd='"%SOFTWARE%\Google\Google Talk\googletalk-setup.exe" /S' />
  <upgrade cmd='taskkill /f /IM googletalk.exe'><exit code="any" /></upgrade>
  <upgrade cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v googletalk /f'><exit code="1" /></upgrade>
  <upgrade cmd='REG DELETE "HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Run" /v googletalk /f' architecture="x64"><exit code="1" /></upgrade>

  <downgrade cmd='"%SOFTWARE%\Google\Google Talk\googletalk-setup.exe" /S' />
  <downgrade cmd='taskkill /f /IM googletalk.exe'><exit code="any" /></downgrade>
  <downgrade cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v googletalk /f'><exit code="1" /></downgrade>
  <downgrade cmd='REG DELETE "HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Run" /v googletalk /f' architecture="x64"><exit code="1" /></downgrade>

  <remove cmd='taskkill /f /IM googletalk.exe'><exit code="any" /></remove>
  <remove cmd='%COMSPEC% /c IF EXIST "%PROGRAMFILES%\Google\Google Talk\uninstall.exe" "%PROGRAMFILES%\Google\Google Talk\uninstall.exe" /S' />
  <remove cmd='%COMSPEC% /c IF EXIST "%PROGRAMFILES(x86)%\Google\Google Talk\uninstall.exe" "%PROGRAMFILES%\Google\Google Talk\uninstall.exe" /S' />

</package>

<package
  id="googleappssync"
  name="Google Apps Sync"
  revision="%version%-0"
  priority="10"
  reboot="false">

  <variable name="version" value="2.3.22.703" />

  <check type="logical" condition="or">
    <check type="file" condition="versiongreaterorequal" path="%PROGRAMFILES%\Google\Google Apps Sync\gsync32.dll" />
    <check type="file" condition="versiongreaterorequal" path="%PROGRAMFILES%\Google\Google Apps Sync\gsync64.dll" />
  </check>

  <install   cmd='msiexec %MSI% /i "%SOFTWARE%\Google\GoogleAppsSync\enterprise_gsync_%PROCESSOR_ARCHITECTURE%.msi"' />
  <upgrade   cmd='msiexec %MSI% /i "%SOFTWARE%\Google\GoogleAppsSync\enterprise_gsync_%PROCESSOR_ARCHITECTURE%.msi"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Google\GoogleAppsSync\enterprise_gsync_%PROCESSOR_ARCHITECTURE%.msi"' />
  <remove    cmd='msiexec %MSI% /i "%SOFTWARE%\Google\GoogleAppsSync\enterprise_gsync_%PROCESSOR_ARCHITECTURE%.msi"' />

</package>

</packages>
