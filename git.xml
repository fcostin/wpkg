<?xml version="1.0" encoding="UTF-8"?>

<!--
  NOTES
  1) Killing explorer.exe before removing was needed for releases older than Aug 2010, HOWEVER it is still needed for upgrades together with vboxservice and sh.exe - I have removed this after all. Killing explorer.exe is just not acceptable.
-->

<packages>

<package
  id="git"
  name="Git for Windows"
  revision="%version%-0"
  priority="10"
  reboot="false">

  <variable name="version" value="1.7.4" />
  <variable name="reldate" value="20110204" />

  <check type="uninstall" condition="exists" path="Git version %version%-preview%reldate%" />

  <install   cmd='taskkill /f /im sh.exe'><exit code="any" /></install>
  <install   cmd='net stop vboxservice'><exit code="any" /></install>
  <install   cmd='"%SOFTWARE%\Git\Git-%version%-preview%reldate%.exe" /SP- /VERYSILENT /NORESTART /SUPPRESSMSGBOXES /LOG' />
  <install   cmd='net start vboxservice'><exit code="any" /></install>

  <upgrade   cmd='taskkill /f /im sh.exe'><exit code="any" /></upgrade>
  <upgrade   cmd='net stop vboxservice'><exit code="any" /></upgrade>
  <upgrade   cmd='"%SOFTWARE%\Git\Git-%version%-preview%reldate%.exe" /SP- /VERYSILENT /NORESTART /SUPPRESSMSGBOXES /LOG' />
  <upgrade   cmd='net start vboxservice'><exit code="any" /></upgrade>

  <downgrade cmd='taskkill /f /im sh.exe'><exit code="any" /></downgrade>
  <downgrade cmd='net stop vboxservice'><exit code="any" /></downgrade>
  <downgrade cmd='"%SOFTWARE%\Git\Git-%version%-preview%reldate%.exe" /SP- /VERYSILENT /NORESTART /SUPPRESSMSGBOXES /LOG' />
  <downgrade cmd='net start vboxservice'><exit code="any" /></downgrade>

  <remove    cmd='taskkill /f /im sh.exe'><exit code="any" /></remove>
  <remove    cmd='net stop vboxservice'><exit code="any" /></remove>
  <remove    cmd='%ComSpec% /c if exist "%ProgramFiles%\Git\unins000.exe"      "%ProgramFiles%\Git\unins000.exe" /SP- /VERYSILENT /NORESTART /SUPPRESSMSGBOXES' />
  <remove    cmd='%ComSpec% /c if exist "%ProgramFiles(x86)%\Git\unins000.exe" "%ProgramFiles(x86)%\Git\unins000.exe" /SP- /VERYSILENT /NORESTART /SUPPRESSMSGBOXES' />
  <remove    cmd='net start vboxservice'><exit code="any" /></remove>

</package>

</packages>
