<?xml version="1.0" encoding="UTF-8"?>
<packages>

  <!-- this is version 2.6.1.4 despite the exe being tagged with 2.6.1.3 -->
  <package
    id="netpas"
    name="Netpas Distance"
    revision="%version%-0"
    reboot="false"
    priority="1">

    <variable name="version" value="2.7.1.3" />

    <check type="uninstall" condition="exists" path="Netpas Distance" />
    <check type='logical' condition='or'>
      <check type="file" condition="versiongreaterorequal" path="%ProgramFiles%\Netpas\Distance\distance.exe" value="%version%" />
      <check type="file" condition="versiongreaterorequal" path="%ProgramFiles(x86)%\Netpas\Distance\distance.exe" value="%version%" />
    </check>

    <install cmd='%SOFTWARE%\Netpas\NetpasDistance.exe /VERYSILENT /sp- /norestart' />
    <install cmd='%COMSPEC% /c del "%ALLUSERSPROFILE%\Desktop\Netpas*.lnk"' />

    <upgrade cmd='%SOFTWARE%\Netpas\NetpasDistance.exe /VERYSILENT /sp- /norestart' />
    <upgrade cmd='%COMSPEC% /c del "%ALLUSERSPROFILE%\Desktop\Netpas*.lnk"' />

    <downgrade cmd='%SOFTWARE%\Netpas\NetpasDistance.exe /VERYSILENT /sp- /norestart' />
    <downgrade cmd='%COMSPEC% /c del "%ALLUSERSPROFILE%\Desktop\Netpas*.lnk"' />
    <!-- Windows 32-bit -->
    <remove cmd='%ComSpec% /c if exist "%ProgramFiles%\Netpas\Distance" "%ProgramFiles%\Netpas\Distance\unins000.exe" /VERYSILENT' />
    <remove cmd='%ComSpec% /c if exist "%ProgramFiles%\Netpas\Distance" RD /Q /S "%ProgramFiles%\Netpas\Distance"' />
    <!-- Windows 64-bit -->
    <remove cmd='%ComSpec% /c if exist "%ProgramFiles(x86)%\Netpas\Distance" "%ProgramFiles(x86)%\Netpas\Distance\unins000.exe" /VERYSILENT' />
    <remove cmd='%ComSpec% /c if exist "%ProgramFiles(x86)%\Netpas\Distance" RD /Q /S "%ProgramFiles(x86)%\Netpas\Distance"' />

  </package>

</packages>
