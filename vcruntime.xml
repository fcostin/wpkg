<?xml version="1.0" encoding="UTF-8"?>

<!--
  NOTES
  1) We install 32 bit libraries on 32 and 64 bit, but 64 only on 64 bit
-->

<packages>

<package
  id="vcruntime"
  name="Visual C++ Runtime 2005 &amp; 2008"
  revision="3"
  reboot="false"
  priority="10">

  <check type="logical" condition="or">
    <check type="uninstall" condition="exists" path="Microsoft Visual C++ 2005 Redistributable" />
    <check type="uninstall" condition="exists" path="Microsoft Visual C++ 2005 Redistributable - x64" />
  </check>
  <check type="logical" condition="or">
    <check type="uninstall" condition="exists" path="Microsoft Visual C++ 2008 Redistributable - x86 9.0.30729.17" />
    <check type="uninstall" condition="exists" path="Microsoft Visual C++ 2008 Redistributable - x64 9.0.30729.17" />
  </check>

  <install cmd='"%SOFTWARE%\VCRuntime\vcredist_2005sp1_x86.exe" /Q /R:N' />
  <install cmd='"%SOFTWARE%\VCRuntime\vcredist_2008sp1_x86.exe" /Q /R:N' />
  <upgrade cmd='"%SOFTWARE%\VCRuntime\vcredist_2005sp1_x86.exe" /Q /R:N' />
  <upgrade cmd='"%SOFTWARE%\VCRuntime\vcredist_2008sp1_x86.exe" /Q /R:N' />

  <install cmd='%COMSPEC% /C IF "%PROCESSOR_ARCHITECTURE%" == "AMD64" "%SOFTWARE%\VCRuntime\vcredist_2005sp1_x64.exe" /Q /R:N' />
  <install cmd='%COMSPEC% /C IF "%PROCESSOR_ARCHITECTURE%" == "AMD64" "%SOFTWARE%\VCRuntime\vcredist_2008sp1_x64.exe" /Q /R:N' />
  <upgrade cmd='%COMSPEC% /C IF "%PROCESSOR_ARCHITECTURE%" == "AMD64" "%SOFTWARE%\VCRuntime\vcredist_2005sp1_x64.exe" /Q /R:N' />
  <upgrade cmd='%COMSPEC% /C IF "%PROCESSOR_ARCHITECTURE%" == "AMD64" "%SOFTWARE%\VCRuntime\vcredist_2008sp1_x64.exe" /Q /R:N' />

</package>

</packages>
