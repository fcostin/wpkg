<?xml version="1.0" encoding="UTF-8"?>

<!--
  NOTES
  1) We install 32 bit libraries on 32 and 64 bit, but 64 only on 64 bit
  2) This checking isn't really that good - on 64b we should check for both 32b and 64b
-->

<packages>

<package
  id="vcruntime"
  name="Visual C++ Runtime 2005, 2008 and 2010"
  revision="6"
  reboot="false"
  priority="10">

  <check type="logical" condition="or">
    <check type="uninstall" condition="versiongreaterorequal" path="Microsoft Visual C++ 2005 Redistributable" value="8.0.56336" />
    <check type="uninstall" condition="exists" path="Microsoft Visual C++ 2005 Redistributable - x64" />
  </check>
  <check type="logical" condition="or">
    <check type="uninstall" condition="exists" path="Microsoft Visual C++ 2008 Redistributable - x86 9.0.30729.17" />
    <check type="uninstall" condition="exists" path="Microsoft Visual C++ 2008 Redistributable - x64 9.0.30729.17" />
  </check>
  <check type="logical" condition="or">
    <check type="uninstall" condition="exists" path="Microsoft Visual C++ 2010  x86 Redistributable - 10.0.30319" />
    <check type="uninstall" condition="exists" path="Microsoft Visual C++ 2010  x64 Redistributable - 10.0.30319" />
  </check>

  <install cmd='"%SOFTWARE%\VCRuntime\vcredist_2005sp1_x86.exe" /Q /R:N'>
    <exit code="3010" />
  </install>
  <install cmd='"%SOFTWARE%\VCRuntime\vcredist_2008sp1_x86.exe" /Q /R:N'>
    <exit code="3010" />
  </install>
  <install cmd='"%SOFTWARE%\VCRuntime\vcredist_2010_x86.exe" /Q /R:N'>
    <exit code="3010" />
  </install>
  <upgrade cmd='"%SOFTWARE%\VCRuntime\vcredist_2005sp1_x86.exe" /Q /R:N'>
    <exit code="3010" />
  </upgrade>
  <upgrade cmd='"%SOFTWARE%\VCRuntime\vcredist_2008sp1_x86.exe" /Q /R:N'>
    <exit code="3010" />
  </upgrade>
  <upgrade cmd='"%SOFTWARE%\VCRuntime\vcredist_2010_x86.exe" /Q /R:N'>
    <exit code="3010" />
  </upgrade>
  <downgrade cmd='"%SOFTWARE%\VCRuntime\vcredist_2005sp1_x86.exe" /Q /R:N'>
    <exit code="3010" />
  </downgrade>
  <downgrade cmd='"%SOFTWARE%\VCRuntime\vcredist_2008sp1_x86.exe" /Q /R:N'>
    <exit code="3010" />
  </downgrade>
  <downgrade cmd='"%SOFTWARE%\VCRuntime\vcredist_2010_x86.exe" /Q /R:N'>
    <exit code="3010" />
  </downgrade>

  <install cmd='%COMSPEC% /C IF "%PROCESSOR_ARCHITECTURE%" == "AMD64" "%SOFTWARE%\VCRuntime\vcredist_2005sp1_x64.exe" /Q /R:N'>
    <exit code="3010" />
  </install>
  <install cmd='%COMSPEC% /C IF "%PROCESSOR_ARCHITECTURE%" == "AMD64" "%SOFTWARE%\VCRuntime\vcredist_2008sp1_x64.exe" /Q /R:N'>
    <exit code="3010" />
  </install>
  <install cmd='%COMSPEC% /C IF "%PROCESSOR_ARCHITECTURE%" == "AMD64" "%SOFTWARE%\VCRuntime\vcredist_2010_x64.exe" /Q /R:N'>
    <exit code="3010" />
  </install>
  <upgrade cmd='%COMSPEC% /C IF "%PROCESSOR_ARCHITECTURE%" == "AMD64" "%SOFTWARE%\VCRuntime\vcredist_2005sp1_x64.exe" /Q /R:N'>
    <exit code="3010" />
  </upgrade>
  <upgrade cmd='%COMSPEC% /C IF "%PROCESSOR_ARCHITECTURE%" == "AMD64" "%SOFTWARE%\VCRuntime\vcredist_2008sp1_x64.exe" /Q /R:N'>
    <exit code="3010" />
  </upgrade>
  <upgrade cmd='%COMSPEC% /C IF "%PROCESSOR_ARCHITECTURE%" == "AMD64" "%SOFTWARE%\VCRuntime\vcredist_2010_x64.exe" /Q /R:N'>
    <exit code="3010" />
  </upgrade>
  <downgrade cmd='%COMSPEC% /C IF "%PROCESSOR_ARCHITECTURE%" == "AMD64" "%SOFTWARE%\VCRuntime\vcredist_2005sp1_x64.exe" /Q /R:N'>
    <exit code="3010" />
  </downgrade>
  <downgrade cmd='%COMSPEC% /C IF "%PROCESSOR_ARCHITECTURE%" == "AMD64" "%SOFTWARE%\VCRuntime\vcredist_2008sp1_x64.exe" /Q /R:N'>
    <exit code="3010" />
  </downgrade>
  <downgrade cmd='%COMSPEC% /C IF "%PROCESSOR_ARCHITECTURE%" == "AMD64" "%SOFTWARE%\VCRuntime\vcredist_2010_x64.exe" /Q /R:N'>
    <exit code="3010" />
  </downgrade>
</package>

</packages>
