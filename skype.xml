<?xml version="1.0" encoding="UTF-8"?>

<!--
  NOTES
  1) Skype uses a TM symbol in the name in the Uninstall string so to play it safe, we instead check the version of the file name directly
  2) Furthermore, the versions are different. Uninstall version would be 5.0.156 but fileversion is 5.0.32.156
  3) INSTALLLEVEL=1 means no toolbars
-->

<packages>

<package
  id="skype"
  name="Skype 5.0"
  revision="%version%-0"
  reboot="false"
  priority="10">

  <variable name='version' value='5.0.32.156' />
  <check type="logical" condition="or">
    <check type="file" condition="versiongreaterorequal" path="%PROGRAMFILES%\Skype\Phone\Skype.exe" value="%version%" />
    <check type="file" condition="versiongreaterorequal" path="%PROGRAMFILES(x86)%\Skype\Phone\Skype.exe" value="%version%" />
  </check>

  <install   cmd='msiexec %MSI% /i "%SOFTWARE%\Skype\SkypeSetup.msi" INSTALLLEVEL=1 ALLUSERS=1 STARTSKYPE=FALSE' />
  <upgrade   cmd='msiexec %MSI% /i "%SOFTWARE%\Skype\SkypeSetup.msi" INSTALLLEVEL=1 ALLUSERS=1 STARTSKYPE=FALSE' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Skype\SkypeSetup.msi" INSTALLLEVEL=1 ALLUSERS=1 STARTSKYPE=FALSE' />
  <remove    cmd='%COMSPEC% /C if exist "%PROGRAMFILES%\Skype\Phone\Skype.exe" "%PROGRAMFILES%\Skype\Phone\Skype.exe" /shutdown' />
  <remove    cmd='%COMSPEC% /C if exist "%PROGRAMFILES(x86)%\Skype\Phone\Skype.exe" "%PROGRAMFILES(x86)%\Skype\Phone\Skype.exe" /shutdown' />
  <remove    cmd='msiexec %MSI% /x "%SOFTWARE%\Skype\SkypeSetup.msi"' />

</package>

</packages>
