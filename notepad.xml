<?xml version="1.0" encoding="UTF-8"?>

<!--
  NOTES
  1) We remove the plugins to prevent the installer from hanging
-->


<packages xmlns:xsi="http://www.wpkg.org/packages" xsi:noNamespaceSchemaLocation="xsd/packages.xsd">

<package
  id="notepad"
  name="Notepad++"
  revision="%version%-0"
  reboot="false"
  priority="10">

  <variable name="version" value="5.9" />
  <variable name="PKG_DESTINATION" value="%PROGRAMFILES%\Notepad++"      architecture="x86" />
  <variable name="PKG_DESTINATION" value="%PROGRAMFILES(x86)%\Notepad++" architecture="x64" />

  <check type='logical' condition='and'>
    <check type="uninstall" condition="versiongreaterorequal" path="Notepad++" value="%version%" />
    <check type="file" condition="versiongreaterorequal" path="%PKG_DESTINATION%\notepad++.exe" value="%version%" />
  </check>

  <install cmd='taskkill /f /im notepad++.exe'><exit code="any" /></install>
  <install cmd='%COMSPEC% /c RD /Q /S "%PKG_DESTINATION%\plugins"'><exit code="any" /></install>
  <install cmd='"%SOFTWARE%\Notepad\npp.%version%.Installer.exe" /S' />

  <upgrade cmd='taskkill /f /im notepad++.exe'><exit code="any" /></upgrade>
  <upgrade cmd='%COMSPEC% /c RD /Q /S "%PKG_DESTINATION%\plugins"'><exit code="any" /></upgrade>
  <upgrade cmd='"%SOFTWARE%\Notepad\npp.%version%.Installer.exe" /S' />

  <downgrade cmd='taskkill /f /im notepad++.exe'><exit code="any" /></downgrade>
  <downgrade cmd='%COMSPEC% /c RD /Q /S "%PKG_DESTINATION%\plugins"'><exit code="any" /></downgrade>
  <downgrade cmd='"%SOFTWARE%\Notepad\npp.%version%.Installer.exe" /S' />

  <remove cmd='taskkill /f /im notepad++.exe'><exit code="any" /></remove>
  <remove cmd='%COMSPEC% /c RD /Q /S "%PKG_DESTINATION%\plugins"'><exit code="any" /></remove>
  <remove cmd='"%PKG_DESTINATION%\uninstall.exe" /S' />

</package>

</packages>
