<?xml version="1.0" encoding="UTF-8"?>

<!--
  NOTES
  1) You can also download full installers from ftp://ftp.adobe.com/pub/adobe/reader/win/ - check the misc dir for language packs
  2) TODO: This needs to be tested on 64 bit as the start up registry entries need to be deleted from another path on that platform
  3) Enterprise deployment:
  http://www.adobe.com/devnet/acrobat/enterprise_deployment.html
  4) Protect Mode doesn't work when trying to preview pdf in Word
-->

<packages>
  
<package
  id="acrobatreader"
  name="Adobe Acrobat Reader"
  revision="101"
  priority="10"
  execute="once">
  
  <depends package-id="acrobatreaderX" />
  
</package>
    
<package
  id="acrobatreaderX"
  name="Adobe Acrobat Reader X"
  revision="%version%-1"
  reboot="false"
  priority="10">

  <variable name="version" value="10.0.0" />

  <check type="logical" condition="or">
    <check type="uninstall" condition="exists" path="Adobe Reader X" />
    <check type="uninstall" condition="exists" path="Adobe Reader X - Nederlands" />
  </check>

  <install cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Acrobat Reader\pre_install.cmd" "%SOFTWARE%\Acrobat Reader\pre_install.cmd"' />
  <install cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\AdbeRdr1000_en_US.msi" TRANSFORMS="%SOFTWARE%\Acrobat Reader\readerX.mst"'>
    <exit code="3010" reboot="postponed" />
  </install>
  <install cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Acrobat Reader\post_install.cmd" "%SOFTWARE%\Acrobat Reader\post_install.cmd"' />

  <upgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Acrobat Reader\pre_install.cmd" "%SOFTWARE%\Acrobat Reader\pre_install.cmd"' />
  <upgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\AcroRead.msi" TRANSFORMS="%SOFTWARE%\Acrobat Reader\reader9.mst"'>
    <exit code="3010" reboot="postponed" />
  </upgrade>
  <upgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Acrobat Reader\post_install.cmd" "%SOFTWARE%\Acrobat Reader\post_install.cmd"' />

  <downgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Acrobat Reader\pre_install.cmd" "%SOFTWARE%\Acrobat Reader\pre_install.cmd"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\AcroRead.msi" TRANSFORMS="%SOFTWARE%\Acrobat Reader\reader9.mst"'>
    <exit code="3010" reboot="postponed" />
  </downgrade>
  <downgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Acrobat Reader\post_install.cmd" "%SOFTWARE%\Acrobat Reader\post_install.cmd"' />

  <remove cmd='msiexec %MSI% /x "%SOFTWARE%\Acrobat Reader\AcroRead.msi"' />
  <remove cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Acrobat Reader\post_install.cmd" "%SOFTWARE%\Acrobat Reader\post_install.cmd"' />

</package>

<package
  id="acrobatreader9"
  name="Adobe Acrobat Reader 9"
  revision="%version%-1"
  reboot="false"
  priority="10">

  <variable name="version" value="9.4.1" />

  <check type="logical" condition="or">
    <check type="uninstall" condition="exists" path="Adobe Reader %version%" />
    <check type="uninstall" condition="exists" path="Adobe Reader %version% - Nederlands" />
  </check>

  <!-- First uninstall Adobe Reader 8.1.2 -->
  <install cmd='msiexec /x{AC76BA86-7AD7-1033-7B44-A80000000002} /qn ' >
    <exit code="1605" />
    <exit code="1618" />
  </install>
  <install cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.0" ' ><exit code="any" /></install>
  <install cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.1" ' ><exit code="any" /></install>
  <install cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.2" ' ><exit code="any" /></install>
  <!--
  <install cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 9.0" ' ><exit code="any" /></install>
  -->
  <install cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Acrobat Reader\pre_install.cmd" "%SOFTWARE%\Acrobat Reader\pre_install.cmd"' />
  <install cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\AcroRead.msi" TRANSFORMS="%SOFTWARE%\Acrobat Reader\reader9.mst"'>
    <exit code="3010" reboot="postponed" />
  </install>
  <install cmd='msiexec %MSI% /p "%SOFTWARE%\Acrobat Reader\AdbeRdrUpd941_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="postponed" />
  </install>
  <!--
  <install cmd='msiexec %MSI% /p "%SOFTWARE%\Acrobat Reader\AdbeRdrUpd933_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="postponed" />
  </install>
  <install cmd='msiexec %MSI% /p "%SOFTWARE%\Acrobat Reader\AdbeRdrUpd934_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="postponed" />
  </install>
  -->
  <install cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Acrobat Reader\post_install.cmd" "%SOFTWARE%\Acrobat Reader\post_install.cmd"' />
  <install cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe Reader Speed Launcher" /f'>
    <exit code="1" />
  </install>
  <install cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe ARM" /f'>
    <exit code="1" />
  </install>

  <!-- First uninstall Adobe Reader 8.1.2 -->
  <upgrade cmd='msiexec /x{AC76BA86-7AD7-1033-7B44-A80000000002} /qn ' >
    <exit code="1605" />
    <exit code="1618" />
  </upgrade>
  <upgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.0" ' ><exit code="any" /></upgrade>
  <upgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.1" ' ><exit code="any" /></upgrade>
  <upgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.2" ' ><exit code="any" /></upgrade>
  <!--
  <upgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 9.0" ' ><exit code="any" /></upgrade>
  -->
  <upgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Acrobat Reader\pre_install.cmd" "%SOFTWARE%\Acrobat Reader\pre_install.cmd"' />
  <upgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\AcroRead.msi" TRANSFORMS="%SOFTWARE%\Acrobat Reader\reader9.mst"'>
    <exit code="3010" reboot="postponed" />
  </upgrade>
  <upgrade cmd='msiexec %MSI% /p "%SOFTWARE%\Acrobat Reader\AdbeRdrUpd941_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="postponed" />
  </upgrade>
  <!--
  <upgrade cmd='msiexec %MSI% /p "%SOFTWARE%\Acrobat Reader\AdbeRdrUpd933_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="postponed" />
  </upgrade>
  <upgrade cmd='msiexec %MSI% /p "%SOFTWARE%\Acrobat Reader\AdbeRdrUpd934_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="postponed" />
  </upgrade>
  -->
  <upgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Acrobat Reader\post_install.cmd" "%SOFTWARE%\Acrobat Reader\post_install.cmd"' />
  <upgrade cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe Reader Speed Launcher" /f'>
    <exit code="1" />
  </upgrade>
  <upgrade cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe ARM" /f'>
    <exit code="1" />
  </upgrade>

  <!-- First uninstall Adobe Reader 8.1.2 -->
  <downgrade cmd='msiexec /x{AC76BA86-7AD7-1033-7B44-A80000000002} /qn ' >
   <exit code="1605" />
   <exit code="1618" />
  </downgrade>
  <downgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.0" ' ><exit code="any" /></downgrade>
  <downgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.1" ' ><exit code="any" /></downgrade>
  <downgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.2" ' ><exit code="any" /></downgrade>
  <!--
  <downgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 9.0" ' ><exit code="any" /></downgrade>
  -->
  <downgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Acrobat Reader\pre_install.cmd" "%SOFTWARE%\Acrobat Reader\pre_install.cmd"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\AcroRead.msi" TRANSFORMS="%SOFTWARE%\Acrobat Reader\reader9.mst"'>
    <exit code="3010" reboot="postponed" />
  </downgrade>
  <downgrade cmd='msiexec %MSI% /p "%SOFTWARE%\Acrobat Reader\AdbeRdrUpd941_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="postponed" />
  </downgrade>
  <!--
  <downgrade cmd='msiexec %MSI% /p "%SOFTWARE%\Acrobat Reader\AdbeRdrUpd933_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="postponed" />
  </downgrade>
  <downgrade cmd='msiexec %MSI% /p "%SOFTWARE%\Acrobat Reader\AdbeRdrUpd934_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="postponed" />
  </downgrade>
  -->
  <downgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Acrobat Reader\post_install.cmd" "%SOFTWARE%\Acrobat Reader\post_install.cmd"' />
  <downgrade cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe Reader Speed Launcher" /f'>
    <exit code="1" />
  </downgrade>
  <downgrade cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe ARM" /f'>
    <exit code="1" />
  </downgrade>

  <remove cmd='msiexec %MSI% /x "%SOFTWARE%\Acrobat Reader\AcroRead.msi"' />
  <remove cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe Reader Speed Launcher" /f'>
    <exit code="1" />
  </remove>
  <remove cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe ARM" /f'>
    <exit code="1" />
  </remove>

</package>

<package
  id="adobewizard"
  name="Adobe Customization Wizard X"
  revision="%version%-2"
  reboot="false"
  priority="10">

  <variable name="version" value="10.0.0" />

  <check type="uninstall" condition="exists" path="Adobe Customization Wizard X" />

  <install   cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\CustWiz.msi"' />
  <upgrade   cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\CustWiz.msi"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\CustWiz.msi"' />
  <remove    cmd='msiexec %MSI% /x "%SOFTWARE%\Acrobat Reader\CustWiz.msi"' />
</package>

<package
  id="acrobat_jp"
  name="Acrobat Reader X - Japanese Font Pack"
  revision="%version%-0"
  reboot="false"
  priority="10">

  <variable name="version" value="10.0.0" />
  
  <depends package-id="acrobatreaderX" />

  <check type="uninstall" condition="versiongreaterorequal" path="Japanese Fonts Support For Adobe Reader X" value="%version%" />

  <install   cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\FontPack1000_ja_JP.msi"' />
  <upgrade   cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\FontPack1000_ja_JP.msi"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\FontPack1000_ja_JP.msi"' />
  <remove    cmd='msiexec %MSI% /x "%SOFTWARE%\Acrobat Reader\FontPack1000_ja_JP.msi"' />
</package>  

<package
  id="acrobat_cn"
  name="Acrobat Reader X - Chinese Font Pack"
  revision="%version%-0"
  reboot="false"
  priority="10">

  <variable name="version" value="10.0.0" />
  
  <depends package-id="acrobatreaderX" />

  <check type="uninstall" condition="versiongreaterorequal" path="Chinese Simplified Fonts Support For Adobe Reader X" value="%version%" />

  <install   cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\FontPack1000_zh_CN.msi"' />
  <upgrade   cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\FontPack1000_zh_CN.msi"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\FontPack1000_zh_CN.msi"' />
  <remove    cmd='msiexec %MSI% /x "%SOFTWARE%\Acrobat Reader\FontPack1000_zh_CN.msi"' />
</package>  

<package
  id="acrobat_kr"
  name="Acrobat Reader X - Korean Font Pack"
  revision="%version%-0"
  reboot="false"
  priority="10">

  <variable name="version" value="10.0.0" />

  <depends package-id="acrobatreaderX" />

  <check type="uninstall" condition="versiongreaterorequal" path="Korean Fonts Support For Adobe Reader X" value="%version%" />

  <install   cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\FontPack1000_ko_KR.msi"' />
  <upgrade   cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\FontPack1000_ko_KR.msi"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\FontPack1000_ko_KR.msi"' />
  <remove    cmd='msiexec %MSI% /x "%SOFTWARE%\Acrobat Reader\FontPack1000_ko_KR.msi"' />
</package>

<package
  id="acrobat_jp_9"
  name="Acrobat Reader 9 Japanese"
  revision="%version%-2"
  reboot="false"
  priority="10">

  <variable name="version" value="9.0.0" />
  
  <depends package-id="acrobatreader9" />

  <check type="uninstall" condition="versiongreaterorequal" path="Japanese Fonts Support For Adobe Reader 9" value="%version%" />
  <install   cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\FontPack90_ja_JP.msi"' />
  <upgrade   cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\FontPack90_ja_JP.msi"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\FontPack90_ja_JP.msi"' />
  <remove    cmd='msiexec %MSI% /x "%SOFTWARE%\Acrobat Reader\FontPack90_ja_JP.msi"' />

</package>  

</packages>
