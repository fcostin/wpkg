<?xml version="1.0" encoding="UTF-8"?>

<!--
  NOTES
  1) Not tested on 64 bit
  2) Previous version 3.5 would fail when installed as SYSTEM
  3) We must uninstall v3 before installing v4
  4) I've added copying the msi to c:\ - it's technically not necessary, but if for some reason the client isn't installed correctly, people have real problems, so it's just to be safe
-->

<packages>

<package
  id="netextender"
  name="SonicWALL SSL-VPN NetExtender"
  revision="%version%-7"
  reboot="false"
  priority="10">

  <variable name="version" value="4.0.138" />

  <check type="uninstall" condition="versiongreaterorequal" path="SonicWALL SSL-VPN NetExtender" value="%version%" />

  <install cmd='msiexec /i  "%SOFTWARE%\SonicWall VPN\NetExtender.%version%.msi" %MSI%'>
    <exit code="3010" reboot="postponed" />
  </install>
  <install cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\SonicWall VPN\NetExtender.reg" regedit /s "%SOFTWARE%\SonicWall VPN\NetExtender.reg" '/>
  <install cmd='xcopy /Y "%SOFTWARE%\SonicWall VPN\NetExtender.%version%.msi" c:\' />

  <upgrade cmd='msiexec /i  "%SOFTWARE%\SonicWall VPN\NetExtender.%version%.msi" %MSI%'>
    <exit code="3010" reboot="postponed" />
  </upgrade>
  <upgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\SonicWall VPN\NetExtender.reg" regedit /s "%SOFTWARE%\SonicWall VPN\NetExtender.reg" '/>
  <upgrade cmd='xcopy /Y "%SOFTWARE%\SonicWall VPN\NetExtender.%version%.msi" c:\' />

  <downgrade cmd='msiexec /i "%SOFTWARE%\SonicWall VPN\NetExtender.%version%.msi" %MSI%'>
    <exit code="3010" reboot="postponed" />
  </downgrade>
  <downgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\SonicWall VPN\NetExtender.reg" regedit /s "%SOFTWARE%\SonicWall VPN\NetExtender.reg" '/>
  <downgrade cmd='xcopy /Y "%SOFTWARE%\SonicWall VPN\NetExtender.%version%.msi" c:\' />

  <remove    cmd='msiexec /x  "%SOFTWARE%\SonicWall VPN\NetExtender.%version%.msi" %MSI%' />

</package>

</packages>
