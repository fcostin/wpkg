<?xml version="1.0" encoding="UTF-8"?>

<!--
  TODO
  1) Copy firefox_installer.ini from here to where you placed the firefox installer

  NOTES
  1) Thunderbird is not updated - patches are welcome!
  2) From v4 the firefox installer now writes the language to the uninstall string so we have to check for all languages - however wpkg does not support a logical or with only one entry so it's commented out until we add more

-->

<packages>

<package
  id="firefox"
  name="Mozilla Firefox"
  revision="%version%-0"
  reboot="false"
  priority="10">

  <variable name="version" value="7.0.1" />
  <variable name="PKG_DESTINATION" value="%PROGRAMFILES%\Mozilla Firefox"      architecture="x86" />
  <variable name="PKG_DESTINATION" value="%PROGRAMFILES(x86)%\Mozilla Firefox" architecture="x64" />

  <check type="uninstall" condition="exists" path="Mozilla Firefox %version% (.*)" />

  <install   cmd='"%SOFTWARE%\Mozilla\Firefox\Firefox Setup %version%.exe" /S /INI="%SOFTWARE%\Mozilla\Firefox\installer.ini"' />
  <upgrade   cmd='"%SOFTWARE%\Mozilla\Firefox\Firefox Setup %version%.exe" /S /INI="%SOFTWARE%\Mozilla\Firefox\installer.ini"' />
  <downgrade cmd='"%SOFTWARE%\Mozilla\Firefox\Firefox Setup %version%.exe" /S /INI="%SOFTWARE%\Mozilla\Firefox\installer.ini"' />
  <remove cmd='%ComSpec% /c if exist "%PKG_DESTINATION%\uninstall\helper.exe" "%PKG_DESTINATION%\uninstall\helper.exe" /S' />

</package>

<package
  id="firefox3"
  name="Mozilla Firefox"
  revision="%version%-0"
  reboot="false"
  priority="10">

  <variable name="version" value="3.6.22" />
  <variable name="PKG_DESTINATION" value="%PROGRAMFILES%\Mozilla Firefox"      architecture="x86" />
  <variable name="PKG_DESTINATION" value="%PROGRAMFILES(x86)%\Mozilla Firefox" architecture="x64" />

  <check type="uninstall" condition="exists" path="Mozilla Firefox (%version%)" />

  <install   cmd='"%SOFTWARE%\Mozilla\Firefox\Firefox Setup %version%.exe" /S /INI="%SOFTWARE%\Mozilla\Firefox\installer.ini"' />
  <upgrade   cmd='"%SOFTWARE%\Mozilla\Firefox\Firefox Setup %version%.exe" /S /INI="%SOFTWARE%\Mozilla\Firefox\installer.ini"' />
  <downgrade cmd='"%SOFTWARE%\Mozilla\Firefox\Firefox Setup %version%.exe" /S /INI="%SOFTWARE%\Mozilla\Firefox\installer.ini"' />
  <remove cmd='%ComSpec% /c if exist "%PKG_DESTINATION%\uninstall\helper.exe" "%PKG_DESTINATION%\uninstall\helper.exe" /S' />

</package>

<package
  id="thunderbird"
  name="Mozilla Thunderbird"
  revision="%version%-0"
  reboot="false"
  priority="10">

  <variable name="version" value="3.1.14" />
  <variable name="PKG_DESTINATION" value="%PROGRAMFILES%\Mozilla Thunderbird"      architecture="x86" />
  <variable name="PKG_DESTINATION" value="%PROGRAMFILES(x86)%\Mozilla Thunderbird" architecture="x64" />

  <check type="uninstall" condition="exists" path="Mozilla Thunderbird (%version%)" />

  <install cmd='taskkill.exe /f /im thunderbird.exe'><exit code="any" /></install>
  <install cmd='"%SOFTWARE%\Mozilla\Thunderbird\Thunderbird Setup %version%.exe" -ms' />

  <upgrade cmd='taskkill.exe /f /im thunderbird.exe'><exit code="any" /></upgrade>
  <upgrade cmd='"%SOFTWARE%\Mozilla\Thunderbird\Thunderbird Setup %version%.exe" -ms' />

  <downgrade cmd='taskkill.exe /f /im thunderbird.exe'><exit code="any" /></downgrade>
  <downgrade cmd='"%SOFTWARE%\Mozilla\Thunderbird\Thunderbird Setup %version%.exe" -ms' />

  <remove  cmd='taskkill.exe /f /im thunderbird.exe'><exit code="any" /></remove>
  <remove  cmd='"%PKG_DESTINATION%\uninstall\helper.exe" /S' />

</package>

</packages>
